# Python è™šæ‹Ÿç¯å¢ƒç®¡ç†å·¥å…·

è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„Pythonè™šæ‹Ÿç¯å¢ƒç®¡ç†å·¥å…·ï¼Œä¸“ä¸ºç®€åŒ–è™šæ‹Ÿç¯å¢ƒçš„åˆ›å»ºã€ç®¡ç†å’ŒPyTorchå®‰è£…è€Œè®¾è®¡ã€‚

## ç‰¹æ€§

âœ¨ **æ ¸å¿ƒåŠŸèƒ½**
- ğŸš€ åœ¨ç»Ÿä¸€è·¯å¾„ `/mnt/data/wangj/venvs` ä¸‹åˆ›å»ºå’Œç®¡ç†è™šæ‹Ÿç¯å¢ƒ
- ğŸ”„ ç®€å•çš„å‘½ä»¤è¿›å…¥/é€€å‡ºè™šæ‹Ÿç¯å¢ƒ
- ğŸ¤– è¿›å…¥ç¯å¢ƒæ—¶è‡ªåŠ¨æ£€æµ‹å¹¶å®‰è£…PyTorchï¼ˆä½¿ç”¨ROCm 7.1ï¼‰
- ğŸ“‹ æŸ¥çœ‹æ‰€æœ‰è™šæ‹Ÿç¯å¢ƒåˆ—è¡¨åŠå…¶çŠ¶æ€
- ğŸ¨ å½©è‰²ç»ˆç«¯è¾“å‡ºï¼Œç”¨æˆ·å‹å¥½çš„ç•Œé¢

âœ¨ **ä¾¿æ·ç‰¹æ€§**
- è‡ªå®šä¹‰ç¯å¢ƒåç§°
- æ˜¾ç¤ºPythonå’ŒPyTorchç‰ˆæœ¬ä¿¡æ¯
- å‘½ä»¤è‡ªåŠ¨è¡¥å…¨
- é”™è¯¯å¤„ç†å’ŒçŠ¶æ€æç¤º
- ç¯å¢ƒçŠ¶æ€æŸ¥çœ‹

## å®‰è£…æ­¥éª¤

### 1. ä¸‹è½½å·¥å…·æ–‡ä»¶

ç¡®ä¿ä»¥ä¸‹æ–‡ä»¶åœ¨åŒä¸€ç›®å½•ä¸‹ï¼š
- `venv_manager.py` - Pythonç®¡ç†è„šæœ¬
- `venv_helper.sh` - Shellè¾…åŠ©è„šæœ¬

### 2. èµ‹äºˆæ‰§è¡Œæƒé™

```bash
chmod +x venv_manager.py
chmod +x venv_helper.sh
```

### 3. é…ç½®Shellç¯å¢ƒ

åœ¨æ‚¨çš„ `~/.bashrc` æˆ– `~/.zshrc` æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```bash
# Pythonè™šæ‹Ÿç¯å¢ƒç®¡ç†å·¥å…·
source /mnt/data/wangj/workspace/tritonupstream/venv_helper.sh
```

**æ³¨æ„**ï¼šè¯·æ ¹æ®å®é™…è·¯å¾„è°ƒæ•´ä¸Šè¿°è·¯å¾„ã€‚

### 4. é‡æ–°åŠ è½½Shellé…ç½®

```bash
source ~/.bashrc  # å¦‚æœä½¿ç”¨bash
# æˆ–
source ~/.zshrc   # å¦‚æœä½¿ç”¨zsh
```

## ä½¿ç”¨æŒ‡å—

### åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

```bash
# åˆ›å»ºåä¸º 'myproject' çš„è™šæ‹Ÿç¯å¢ƒ
venv-create myproject

# ä½¿ç”¨ç‰¹å®šPythonç‰ˆæœ¬åˆ›å»ºç¯å¢ƒ
venv-create myproject --python python3.11
```

### æŸ¥çœ‹æ‰€æœ‰è™šæ‹Ÿç¯å¢ƒ

```bash
venv-list
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
è™šæ‹Ÿç¯å¢ƒåˆ—è¡¨:

ç¯å¢ƒåç§°               Pythonç‰ˆæœ¬       PyTorchç‰ˆæœ¬           è·¯å¾„
------------------------------------------------------------------------------------------
myproject            Python 3.10.12  2.7.0+git123456      /mnt/data/wangj/venvs/myproject
test_env             Python 3.11.5   æœªå®‰è£…                /mnt/data/wangj/venvs/test_env

æ€»è®¡: 2 ä¸ªè™šæ‹Ÿç¯å¢ƒ
```

### è¿›å…¥è™šæ‹Ÿç¯å¢ƒ

```bash
venv-enter myproject
```

è¿›å…¥ç¯å¢ƒåï¼Œå·¥å…·ä¼šï¼š
1. âœ… æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
2. ğŸ” è‡ªåŠ¨æ£€æµ‹PyTorchå®‰è£…çŠ¶æ€
3. ğŸ“¦ å¦‚æœæœªå®‰è£…PyTorchï¼Œè‡ªåŠ¨æ‰§è¡Œå®‰è£…ï¼ˆä½¿ç”¨ROCm 7.1 nightlyç‰ˆæœ¬ï¼‰

è¾“å‡ºç¤ºä¾‹ï¼š
```
âœ“ å·²è¿›å…¥è™šæ‹Ÿç¯å¢ƒ: myproject
â„¹ Python 3.10.12
â„¹ è·¯å¾„: /mnt/data/wangj/venvs/myproject

æ­£åœ¨æ£€æŸ¥ PyTorch å®‰è£…çŠ¶æ€...
âš  PyTorch æœªå®‰è£…ï¼Œå¼€å§‹è‡ªåŠ¨å®‰è£…...
â„¹ å®‰è£…å‘½ä»¤: pip3 install torch --index-url https://download.pytorch.org/whl/nightly/rocm7.1 --no-build-isolation
âœ“ PyTorch å®‰è£…æˆåŠŸï¼(ç‰ˆæœ¬: 2.7.0+git123456)

â„¹ ä½¿ç”¨ 'venv-exit' é€€å‡ºè™šæ‹Ÿç¯å¢ƒ
```

### æŸ¥çœ‹å½“å‰ç¯å¢ƒçŠ¶æ€

```bash
venv-status
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
å½“å‰è™šæ‹Ÿç¯å¢ƒ:
  åç§°: myproject
  Python: Python 3.10.12
  è·¯å¾„: /mnt/data/wangj/venvs/myproject
  PyTorch: 2.7.0+git123456
```

### é€€å‡ºè™šæ‹Ÿç¯å¢ƒ

```bash
venv-exit
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
âœ“ å·²é€€å‡ºè™šæ‹Ÿç¯å¢ƒ: myproject
â„¹ å·²è¿”å›ç³»ç»Ÿé»˜è®¤Pythonç¯å¢ƒ
```

### åˆ é™¤è™šæ‹Ÿç¯å¢ƒ

```bash
venv-delete myproject
```

ç³»ç»Ÿä¼šè¦æ±‚ç¡®è®¤åå†åˆ é™¤ã€‚

### æŸ¥çœ‹å¸®åŠ©

```bash
venv-help
```

## å®Œæ•´å‘½ä»¤åˆ—è¡¨

| å‘½ä»¤ | æè¿° | ç¤ºä¾‹ |
|------|------|------|
| `venv-create <åç§°>` | åˆ›å»ºæ–°çš„è™šæ‹Ÿç¯å¢ƒ | `venv-create myenv` |
| `venv-list` | åˆ—å‡ºæ‰€æœ‰è™šæ‹Ÿç¯å¢ƒ | `venv-list` |
| `venv-enter <åç§°>` | è¿›å…¥æŒ‡å®šçš„è™šæ‹Ÿç¯å¢ƒ | `venv-enter myenv` |
| `venv-exit` | é€€å‡ºå½“å‰è™šæ‹Ÿç¯å¢ƒ | `venv-exit` |
| `venv-delete <åç§°>` | åˆ é™¤æŒ‡å®šçš„è™šæ‹Ÿç¯å¢ƒ | `venv-delete myenv` |
| `venv-status` | æ˜¾ç¤ºå½“å‰ç¯å¢ƒçŠ¶æ€ | `venv-status` |
| `venv-help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ | `venv-help` |

## PyTorchå®‰è£…è¯´æ˜

å·¥å…·åœ¨è¿›å…¥è™šæ‹Ÿç¯å¢ƒæ—¶ä¼šè‡ªåŠ¨æ£€æµ‹PyTorchå®‰è£…çŠ¶æ€ã€‚å¦‚æœæœªå®‰è£…ï¼Œä¼šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
pip3 install torch --index-url https://download.pytorch.org/whl/nightly/rocm7.1 --no-build-isolation
```

æ­¤å‘½ä»¤ï¼š
- ä½¿ç”¨ PyTorch nightly ç‰ˆæœ¬
- é’ˆå¯¹ ROCm 7.1 ä¼˜åŒ–
- è·³è¿‡æ„å»ºéš”ç¦»ä»¥åŠ å¿«å®‰è£…é€Ÿåº¦

æ‚¨ä¹Ÿå¯ä»¥æ‰‹åŠ¨è§¦å‘PyTorchæ£€æŸ¥å’Œå®‰è£…ï¼š

```bash
# ä½¿ç”¨Pythonè„šæœ¬ç›´æ¥æ£€æŸ¥
python3 venv_manager.py check-pytorch myproject
```

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æ›´æ”¹è™šæ‹Ÿç¯å¢ƒçš„é»˜è®¤è·¯å¾„ï¼Ÿ

A: ç¼–è¾‘ `venv_manager.py` å’Œ `venv_helper.sh` ä¸­çš„ `VENV_BASE_PATH` å˜é‡ã€‚

### Q: å¯ä»¥å®‰è£…ä¸åŒç‰ˆæœ¬çš„PyTorchå—ï¼Ÿ

A: å¯ä»¥ã€‚è¿›å…¥ç¯å¢ƒåï¼Œæ‰‹åŠ¨è¿è¡Œ `pip install` å‘½ä»¤æ¥å®‰è£…æ‚¨éœ€è¦çš„ç‰ˆæœ¬ã€‚

### Q: å‘½ä»¤è¡¥å…¨ä¸å·¥ä½œï¼Ÿ

A: ç¡®ä¿å·²æ­£ç¡® source `venv_helper.sh` å¹¶ä¸”ä½¿ç”¨çš„æ˜¯ bash shellã€‚

### Q: å¦‚ä½•åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…å…¶ä»–åŒ…ï¼Ÿ

A: è¿›å…¥è™šæ‹Ÿç¯å¢ƒåï¼Œä½¿ç”¨æ ‡å‡†çš„ pip å‘½ä»¤ï¼š
```bash
venv-enter myproject
pip install numpy pandas matplotlib
```

## å·¥ä½œæµç¨‹ç¤ºä¾‹

### åœºæ™¯1ï¼šåˆ›å»ºæ–°é¡¹ç›®ç¯å¢ƒ

```bash
# 1. åˆ›å»ºç¯å¢ƒ
venv-create ml_project

# 2. è¿›å…¥ç¯å¢ƒï¼ˆè‡ªåŠ¨å®‰è£…PyTorchï¼‰
venv-enter ml_project

# 3. å®‰è£…å…¶ä»–ä¾èµ–
pip install numpy pandas scikit-learn

# 4. å¼€å§‹å·¥ä½œ
python train.py

# 5. å®Œæˆåé€€å‡º
venv-exit
```

### åœºæ™¯2ï¼šåˆ‡æ¢é¡¹ç›®ç¯å¢ƒ

```bash
# æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒ
venv-list

# è¿›å…¥é¡¹ç›®Aç¯å¢ƒ
venv-enter project_a
# ... å·¥ä½œä¸­ ...
venv-exit

# è¿›å…¥é¡¹ç›®Bç¯å¢ƒ
venv-enter project_b
# ... å·¥ä½œä¸­ ...
venv-exit
```

### åœºæ™¯3ï¼šæ¸…ç†æ—§ç¯å¢ƒ

```bash
# æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒ
venv-list

# åˆ é™¤ä¸å†ä½¿ç”¨çš„ç¯å¢ƒ
venv-delete old_project
```

## æŠ€æœ¯ç»†èŠ‚

### æ–‡ä»¶ç»“æ„

```
/mnt/data/wangj/workspace/tritonupstream/
â”œâ”€â”€ venv_manager.py       # Pythonç®¡ç†è„šæœ¬ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰
â”œâ”€â”€ venv_helper.sh        # Shellè¾…åŠ©è„šæœ¬ï¼ˆå‘½ä»¤å°è£…ï¼‰
â””â”€â”€ VENV_MANAGER_README.md   # æœ¬æ–‡æ¡£

/mnt/data/wangj/venvs/    # æ‰€æœ‰è™šæ‹Ÿç¯å¢ƒå­˜å‚¨ä½ç½®
â”œâ”€â”€ project1/
â”œâ”€â”€ project2/
â””â”€â”€ ...
```

### å·¥ä½œåŸç†

1. **åˆ›å»ºç¯å¢ƒ**ï¼šä½¿ç”¨Pythonçš„ `venv` æ¨¡å—åˆ›å»ºæ ‡å‡†è™šæ‹Ÿç¯å¢ƒ
2. **æ¿€æ´»ç¯å¢ƒ**ï¼šé€šè¿‡ `source activate` è„šæœ¬æ¿€æ´»ç¯å¢ƒ
3. **æ£€æµ‹PyTorch**ï¼šåœ¨è™šæ‹Ÿç¯å¢ƒçš„Pythonä¸­å°è¯• `import torch`
4. **è‡ªåŠ¨å®‰è£…**ï¼šå¦‚æœå¯¼å…¥å¤±è´¥ï¼Œä½¿ç”¨æŒ‡å®šçš„pipå‘½ä»¤å®‰è£…PyTorch
5. **é€€å‡ºç¯å¢ƒ**ï¼šè°ƒç”¨ `deactivate` å‡½æ•°è¿”å›ç³»ç»Ÿç¯å¢ƒ

## è®¸å¯è¯

æ­¤å·¥å…·ä¸ºå†…éƒ¨ä½¿ç”¨å·¥å…·ï¼Œæ ¹æ®é¡¹ç›®éœ€æ±‚è‡ªç”±ä¿®æ”¹å’Œåˆ†å‘ã€‚

## æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»å·¥å…·ç»´æŠ¤è€…ã€‚

---

**Enjoy coding with clean virtual environments! ğŸš€**

